% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/utils.R
\name{consolidate_graph}
\alias{consolidate_graph}
\title{Consolidate Graph}
\usage{
consolidate_graph(
  graph_df,
  directed = FALSE,
  drop.edges = c("loops", "multiple"),
  consolidate = TRUE,
  keep.nodes = NULL,
  fun.aggregate = fmean,
  ...,
  verbose = TRUE
)
}
\arguments{
\item{graph_df}{A data frame representing a graph with columns:
\code{from} and \code{to} (node IDs), and optionally other columns to preserve.}

\item{directed}{Logical (default: FALSE). Whether the graph is directed.}

\item{drop.edges}{Character vector (default: \code{c("loops", "multiple")}). Types of edges to drop:
\code{"loops"} removes self-loops (edges where from == to),
\code{"multiple"} removes duplicate edges. Set to \code{NULL} to keep all edges.}

\item{consolidate}{Logical (default: TRUE). If TRUE, consolidates the graph by removing
intermediate nodes (nodes that occur exactly twice) and merging connecting edges.
If FALSE, only drops edges as specified in \code{drop.edges}.}

\item{keep.nodes}{Numeric vector (optional). Node IDs to preserve during consolidation,
even if they occur exactly twice.}

\item{fun.aggregate}{Function (default: \code{fmean}). Aggregation function to apply
to columns when consolidating edges. Must be a collapse package function
(e.g., \code{fmean}, \code{fsum}, \code{fmin}, \code{fmax}).}

\item{\dots}{Further arguments passed to \code{fun.aggregate}.}

\item{verbose}{Logical (default: TRUE). Whether to print messages about dropped edges.}
}
\value{
A data frame representing the consolidated graph with:
  \itemize{
    \item All columns from \code{graph_df} (aggregated if consolidation occurred)
    \item Attribute \code{"keep.edges"} - Indices of original edges that were kept
    \item Attribute \code{"gid"} - Edge group IDs mapping consolidated edges to original edges
  }
}
\description{
Consolidate a graph by removing intermediate nodes (nodes that occur exactly twice) and optionally dropping loops and multiple edges. This simplifies the network topology while preserving connectivity.
}
\details{
This function simplifies a graph by:
\itemize{
  \item \strong{Dropping edges}: Optionally removes self-loops and duplicate edges
  \item \strong{Consolidating nodes}: Removes intermediate nodes (nodes that occur exactly twice)
    by merging the two edges connected through them into a single longer edge
  \item \strong{Aggregating attributes}: When edges are merged, numeric attributes are aggregated
    using \code{fun.aggregate} (e.g., mean, sum, min, max)
}

Consolidation is useful for simplifying network topology while preserving connectivity.
For example, if node B connects A->B and B->C, it will be removed and replaced with A->C.
The process continues iteratively until no more nodes can be consolidated.

For undirected graphs, the algorithm also handles cases where a node appears twice
as either origin or destination.
}
\seealso{
\link{create_undirected_graph} \link{simplify_network} \link{flowr-package}
}
