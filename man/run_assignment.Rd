% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/assignment.R
\name{run_assignment}
\alias{run_assignment}
\title{Run Traffic Assignment}
\usage{
run_assignment(
  graph_df,
  od_matrix_long,
  directed = FALSE,
  cost_col = "cost",
  mode_col = NULL,
  method = "PSL",
  lambda = -1,
  beta = -1,
  return.extra = c("graph_df", "od_matrix_long", "paths", "edges", "costs", "weights")
)
}
\arguments{
\item{graph_df}{A data.frame with columns \code{from}, \code{to}, and optionally a cost column.
Represents the network graph with edges between nodes.}

\item{od_matrix_long}{A data.frame with columns \code{from}, \code{to}, and \code{flow}.
Represents the origin-destination matrix in long format with flow values.}

\item{directed}{Logical (default: FALSE). Whether the graph is directed. Currently only
undirected graphs are supported.}

\item{cost_col}{Character string (default: "cost") or numeric vector. Name of the cost column
in \code{graph_df}, or a numeric vector of edge costs with length equal to \code{nrow(graph_df)}.}

\item{mode_col}{Character string (optional). Currently not used.}

\item{method}{Character string (default: "PSL"). Assignment method. Currently only "PSL"
(Path-Sized Logit) is implemented.}

\item{lambda}{Numeric (default: -1). Currently not used.}

\item{beta}{Numeric (default: -1). Path-sized logit parameter (beta_PSL). If -1, uses a default value.}

\item{return.extra}{Character vector specifying additional results to return. Options include:
\code{"graph_df"}, \code{"od_matrix_long"}, \code{"dmat"}, \code{"paths"}, \code{"edges"},
\code{"costs"}, \code{"weights"}. Use \code{"all"} to return all available extra results.
Default: \code{c("graph_df", "od_matrix_long", "paths", "edges", "costs", "weights")}.}
}
\value{
A list containing:
  \itemize{
    \item \code{call} - The function call
    \item \code{final_flows} - Numeric vector of assigned flows for each edge (if \code{graph_df}
      is not in \code{return.extra})
    \item Additional elements as specified in \code{return.extra}
  }
}
\description{
Assign traffic flows to network edges using path-sized logit (PSL) model.
}
\details{
Traffic Assignment Functions

Functions for assigning traffic to routes using nested logit models.


This function performs traffic assignment using a path-sized logit model:
\itemize{
  \item Creates an undirected graph from \code{graph_df} using igraph
  \item Computes shortest path distance matrix for all node pairs
  \item For each origin-destination pair in \code{od_matrix_long}:
    \itemize{
      \item Identifies alternative routes (detours) that are within 10\% of shortest path cost
      \item Finds shortest paths from origin to intermediate nodes and from intermediate nodes to destination
      \item Filters paths to remove those with duplicate edges
      \item Computes path-sized logit probabilities accounting for route overlap
      \item Assigns flows to edges based on probabilities
    }
  \item Returns results including final flows and optionally additional information
}

The path-sized logit model accounts for route overlap by adjusting probabilities based on
the number of alternative routes using each edge. Flows are assigned proportionally to
the computed probabilities.
}
