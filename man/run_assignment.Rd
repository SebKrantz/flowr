% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/assignment.R
\name{run_assignment}
\alias{run_assignment}
\alias{print.flowr}
\title{Run Traffic Assignment}
\usage{
run_assignment(
  graph_df,
  od_matrix_long,
  directed = FALSE,
  cost.column = "cost",
  method = "PSL",
  beta = -1,
  ...,
  detour.max = 1.5,
  angle.max = 90,
  return.extra = NULL,
  precompute.dmat = TRUE,
  verbose = TRUE
)

\method{print}{flowr}(x, ...)
}
\arguments{
\item{graph_df}{A data.frame with columns \code{from}, \code{to}, and optionally a cost column.
Represents the network graph with edges between nodes.}

\item{od_matrix_long}{A data.frame with columns \code{from}, \code{to}, and \code{flow}.
Represents the origin-destination matrix in long format with flow values.}

\item{directed}{Logical (default: FALSE). Whether the graph is directed.}

\item{cost.column}{Character string (default: "cost") or numeric vector. Name of the cost column
in \code{graph_df}, or a numeric vector of edge costs with length equal to \code{nrow(graph_df)}.}

\item{method}{Character string (default: "PSL"). Assignment method. Currently only "PSL"
(Path-Sized Logit) is implemented.}

\item{beta}{Numeric (default: -1). Path-sized logit parameter (beta_PSL).}

\item{\dots}{Additional arguments (currently ignored).}

\item{detour.max}{Numeric (default: 1.5). Maximum detour factor for alternative routes (applied to shortest paths cost). This is a key parameter controlling the execution time of the algorithm: considering more routes (higher \code{detour.max}) substantially increases computation time.}

\item{angle.max}{Numeric (default: 90). Maximum detour angle (in degrees, two sided). I.e., nodes not within this angle measured against a straight line from origin to destination node will not be considered for detours.}

\item{return.extra}{Character vector specifying additional results to return. Options include:
\code{"graph"}, \code{"dmat"}, \code{"paths"} (most memory intensive), \code{"edges"}, \code{"counts"}, \code{"costs"}, and \code{"weights"}.
Use \code{"all"} to return all available extra results.}

\item{precompute.dmat}{description}

\item{verbose}{Show progress bar?}

\item{x}{An object of class \code{flowr}, typically returned by \code{\link{run_assignment}}.}
}
\value{
A list containing:
  \itemize{
    \item \code{call} - The function call
    \item \code{final_flows} - Numeric vector of assigned flows for each edge
    \item Additional elements as specified in \code{return.extra}
  }
}
\description{
Assign traffic flows to network edges using path-sized logit (PSL) model.
}
\details{
This function performs traffic assignment using a path-sized logit model:
\itemize{
  \item Creates a graph from \code{graph_df} using igraph
  \item Computes shortest path distance matrix for all node pairs
  \item For each origin-destination pair in \code{od_matrix_long}:
    \itemize{
      \item Identifies alternative routes (detours) that are within \code{detour.max} of shortest path cost
      \item Finds shortest paths from origin to intermediate nodes and from intermediate nodes to destination
      \item Filters paths to remove those with duplicate edges
      \item Computes path-sized logit probabilities accounting for route overlap
      \item Assigns flows to edges based on probabilities
    }
  \item Returns results including final flows and optionally additional information
}

The path-sized logit model accounts for route overlap by adjusting probabilities based on
the number of alternative routes using each edge. Flows are assigned proportionally to
the computed probabilities.
}
\seealso{
\link{flowr-package}
}
